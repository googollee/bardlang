package main

@import("stdlib/allocator")

func main()
  @with[allocator.allocator] {
  p := @new(mut int, 10) // p : own &int

  {
    q := @as(&mut int, p)

    // compile error:
    // *p = 100
    // r := @as(&mut int, p)
  }

  {
    q := @as(&int, p)
    r := @as(&int, p)

    // compile error:
    // *p = 100
    // r := @as(&mut int, p)
  }

  *p = 100

  q := p // move ownership, q : own &int

  // compile error:
  // r := @as(&int, p)

  // free q automatically
}
